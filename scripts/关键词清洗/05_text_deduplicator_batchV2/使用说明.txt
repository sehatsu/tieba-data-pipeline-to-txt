# 贴吧文本去重工具 - 使用说明

## 功能说明

这个脚本可以帮助你处理贴吧帖子文本中的重复内容：

1. **删除特殊字符**：自动删除 `|`、全角空格`　`、半角空格` `、乱码`�`
2. **智能去重**：检查相邻的非空行是否存在包含关系（字符相同且排序相同）
   - **跳过空行检测**：检测时会自动跳过文件中的空行，只比较非空行之间的关系
   - 例如：第1行有内容，第2行空，第3行有内容 → 会比较第1行和第3行
3. **保留完整内容**：当发现重复时，自动删除较短的行
4. **保持行号**：被删除的行转换为空行，原文件中的空行也会保留

## 使用方法

### 方法一：双击运行（推荐）

1. 双击 `text_deduplicator.py` 文件
2. 按照提示输入：
   - 输入文件路径（要处理的TXT文件）
   - 输出文件路径（结果保存位置）
3. 确认后按 `y` 开始处理
4. 处理完成后按回车键退出

### 方法二：命令行运行

打开命令行/终端，输入：

```bash
python text_deduplicator.py
```

然后按照提示操作。

## 输入路径示例

### Windows系统：
```
C:\Users\用户名\Documents\input.txt
或
C:/Users/用户名/Documents/input.txt
```

### Mac/Linux系统：
```
/Users/用户名/Documents/input.txt
或
~/Documents/input.txt
```

**小贴士**：
- 可以直接拖拽文件到命令行窗口，自动填入完整路径
- 路径中如果有空格，会自动处理，无需添加引号

## 处理效果示例

以您上传的示例文件为例：

```
原始行数: 59
删除行数: 29
保留行数: 30
删除比例: 49.2%
```

### 处理前（部分内容）：
```
第7行: 签到排名：今日本吧第个签到，本吧因你更精彩...（很长的一行）
第8行: 本吧因你更精彩，明天继续来努力！
第9行: 【醒目】大家踊跃报名议团吧！ 只看楼主...（很长的一行）
第10行: 短命郭嘉 | 纠缠盲区13 | | 大家好...（中等长度）
第11行: 短命郭嘉 | 纠缠盲区13 | | 大家好...（短版本）
第12行: 大家好，俺是本届首席吧务...（更短）
第13行: 大家好，俺是本届首席吧务...（最短）
```

### 处理后：
```
第7行: 签到排名：今日本吧第个签到，本吧因你更精彩...（保留）
第8行: （空行 - 已删除）
第9行: 【醒目】大家踊跃报名议团吧！ 只看楼主...（保留）
第10行: （空行 - 已删除）
第11行: （空行 - 已删除）
第12行: （空行 - 已删除）
第13行: （空行 - 已删除）
```

## 常见问题

### Q: 为什么运行后窗口闪退？
**A**: 这是正常的！如果处理成功，输出文件已经生成。脚本在最后会等待你按回车键退出。如果看不到这个提示就闪退了，说明：
- 输入文件路径错误
- 输出文件路径没有写入权限
- 文件编码不是UTF-8

### Q: 如何避免窗口闪退看到错误信息？
**A**: 通过命令行运行：
1. Windows: 按 `Win+R`，输入 `cmd`，回车
2. Mac: 打开"终端"应用
3. 进入脚本所在目录
4. 运行 `python text_deduplicator.py`

### Q: 提示"找不到文件"怎么办？
**A**: 
- 检查文件路径是否正确
- 确保文件确实存在
- 不要使用相对路径，使用完整路径

### Q: 提示"文件编码不是UTF-8"怎么办？
**A**: 
- 用记事本打开文件，另存为时选择UTF-8编码
- 或使用专业文本编辑器（如VSCode、Notepad++）转换编码

### Q: 输出文件没有生成怎么办？
**A**: 
- 确认你有输出路径的写入权限
- 如果输出到系统盘，尝试以管理员身份运行
- 尝试输出到桌面或文档文件夹

### Q: 删除的行可以恢复吗？
**A**: 不能。建议处理前备份原文件，或者输出到新文件（不覆盖原文件）。

## 技术细节

### 去重算法

脚本使用"子序列匹配"算法，并且**跳过空行检测**：

1. 扫描文件，找出所有非空行的位置（清理特殊字符后判断）
2. 只比较相邻的非空行（中间的空行会被跳过）
3. 清理两行的特殊字符后比较
4. 检查较短行的所有字符是否按顺序出现在较长行中
5. 如果是，则认为较短行是较长行的子集，删除较短行
6. 原文件中的空行会被完整保留

示例：
```
行A: （空行）
行B: "大家好俺是本届首席吧务"
行C: （空行）
行D: "大家好，俺是本届首席吧务。经过这一届的无为..."

处理逻辑：
- 识别非空行：B和D
- 跳过空行A和C，直接比较B和D
- 删除特殊字符
- 发现B的所有字符按顺序出现在D中
- 删除较短的行B
- 保留空行A和C
```

### 支持的文件编码
- UTF-8（推荐）
- UTF-8 with BOM

## 版本信息

- 版本：v2.0
- 更新日期：2024
- 作者：Claude

## 联系支持

如遇到其他问题，请提供：
1. 错误提示的完整文本
2. 输入文件的前几行示例
3. 使用的操作系统版本
