# 文本文件处理工具 V4 - 使用说明

## 版本更新说明 (V4)

**核心改进：明确的空行跳过逻辑**

在V4版本中，重复检测逻辑已优化：
- ✅ **空行完全不参与重复检测**：空行会被直接保留到输出文件
- ✅ **只比较非空行**：只有实际包含内容的行才会进行重复比较
- ✅ **忽略空行间隔**：即使两个相同的行之间有空行，仍会被识别为重复

## 功能介绍

这个Python脚本可以帮助您：

1. **删除行首尾特定字符**
   - 竖线 `|`
   - 全角空格 `　`
   - 半角空格 ` `
   - 各种方框符号 `□■◻◼`

2. **检测并处理重复行（跳过空行）**
   - 自动检测相邻的完全相同的**非空行**
   - 空行不参与比较，只作为分隔符保留
   - 将第二个重复行替换为空行（保留第一行）

3. **批量处理**
   - 可以一次处理单个文件
   - 可以一次处理整个文件夹中的所有TXT文件

4. **交互式界面**
   - 通过控制台输入输入/输出路径
   - 实时显示处理进度和结果

## 使用方法

### 1. 运行脚本

在终端/命令提示符中运行：

```bash
python removeduplicatelinesV4.py
```

或者（如果设置了可执行权限）：

```bash
./removeduplicatelinesV4.py
```

### 2. 输入文件路径

脚本会提示您输入TXT文件或文件夹路径：

- **单个文件示例**：
  ```
  C:\Users\YourName\Documents\file.txt
  /home/user/documents/file.txt
  ```

- **文件夹示例**（处理文件夹内所有TXT文件）：
  ```
  C:\Users\YourName\Documents\TextFiles
  /home/user/documents/textfiles
  ```

### 3. 输入输出路径

输入您希望保存处理后文件的文件夹路径：

```
C:\Users\YourName\Documents\Output
/home/user/documents/output
```

### 4. 确认并处理

脚本会显示找到的文件列表，确认后开始处理。

## 处理示例

### 示例 1：基本处理

**输入文件内容：**
```
| 这是第一行　|
  这是第二行  
□这是第三行□
这是第三行
这是第三行
  这是第四行　
```

**输出文件内容：**
```
这是第一行
这是第二行
这是第三行


这是第四行
```

**说明**：
- 第1行：删除了首尾的 `|` 和全角空格 `　`
- 第2行：删除了首尾的半角空格
- 第3行：删除了首尾的方框 `□`
- 第4-5行：与第3行相同，被替换为空行
- 第6行：删除了首尾的半角空格和全角空格

### 示例 2：跳过空行检测（新功能）

**输入文件内容：**
```
这是内容A
这是内容A

这是内容A
这是内容B

这是内容B
```

**输出文件内容：**
```
这是内容A



这是内容B

```

**说明**：
- 第1行：保留"这是内容A"
- 第2行：与第1行重复，替换为空行
- 第3行：原本就是空行，保留
- 第4行：与第1行重复（空行不影响检测），替换为空行
- 第5行：保留"这是内容B"
- 第6行：原本就是空行，保留
- 第7行：与第5行重复（空行不影响检测），替换为空行

**关键点**：即使"这是内容A"和"这是内容B"之间有空行，重复检测仍然有效！

## 注意事项

1. **文件编码**：脚本使用UTF-8编码，确保您的文本文件是UTF-8格式
2. **备份建议**：处理前建议备份原始文件
3. **路径格式**：
   - Windows: 使用 `\` 或 `/` 都可以
   - Linux/Mac: 使用 `/`
   - 路径中的引号会被自动去除
4. **退出程序**：输入 `q` 可以退出程序
5. **空行处理**：
   - 文件中原有的空行会被完全保留
   - 空行不会被当作重复行的"前一行"
   - 检测重复时会跨越空行进行比较

## 技术细节

- **编程语言**：Python 3
- **依赖库**：仅使用Python标准库，无需额外安装
- **支持的字符**：
  - 竖线：`|`
  - 全角空格：`　` (U+3000)
  - 半角空格：` `
  - 白色方框：`□` (U+25A1)
  - 实心方框：`■` (U+25A0)
  - 白色小方框：`◻` (U+25FB)
  - 黑色小方框：`◼` (U+25FC)

### V4 核心逻辑

```python
# 如果是空行，直接保留，不参与重复检测
if not cleaned_line:
    processed_lines.append(原样保留)
    continue  # 跳过重复检测

# 非空行：进行重复检测
if cleaned_line == previous_cleaned_line:
    替换为空行
else:
    保留该行

# 更新比较基准（只记录非空行）
previous_cleaned_line = cleaned_line
```

## 常见问题

**Q: 如何处理子文件夹中的文件？**  
A: 目前脚本只处理指定文件夹中的文件，不包括子文件夹。如需处理子文件夹，可以分别指定。

**Q: 可以处理其他格式的文件吗？**  
A: 目前仅支持 .txt 文件。如需处理其他格式，需要修改脚本。

**Q: 如何修改要删除的字符？**  
A: 在脚本的 `clean_line` 函数中修改 `chars_to_remove` 变量。

**Q: 处理后的文件名是否会改变？**  
A: 不会，输出文件名与输入文件名相同。

**Q: 空行会影响重复检测吗？**  
A: 不会！V4版本明确跳过空行检测，只比较非空行。即使两个相同的行之间有多个空行，仍会被识别为重复。

**Q: 原文件中的空行会丢失吗？**  
A: 不会！所有原有的空行都会被保留在输出文件中。

## 版本历史

- **V4 (当前版本)**：明确的空行跳过逻辑，优化代码结构和注释
- **V3**：基本功能实现

## 联系支持

如有问题或建议，欢迎反馈！
